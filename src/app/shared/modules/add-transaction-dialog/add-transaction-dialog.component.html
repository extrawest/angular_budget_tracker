<div [formGroup]="form">
  <div class="grid">
    <div class="col-12">
      <div class="grid">
        <div class="col-6">
          <label class="block text-900 font-medium text-sm mb-2">Amount</label>
          <p-inputNumber
            min="0"
            formControlName="amount"
            styleClass="block"
            inputStyleClass="w-full"
            mode="currency"
            [currency]="form.controls.currency.value"
            class="block"
          ></p-inputNumber>
          <app-error [control]="form.controls.amount" field="Amount"></app-error>
        </div>

        <div class="col-4">
          <label class="block text-900 font-medium text-sm mb-2">Currency</label>
          <p-dropdown
            [options]="currencies$ | async"
            styleClass="w-full"
            formControlName="currency"
            optionLabel="name"
            optionValue="name"
          ></p-dropdown>
          <app-error [control]="form.controls.currency" field="Currency"></app-error>
        </div>

        <div class="col-2 flex flex-column">
          <label class="block text-900 font-medium text-sm mb-2">Income</label>
          <div class="h-full flex align-items-center">
            <p-inputSwitch
              formControlName="income"
            ></p-inputSwitch>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12">
      <label class="block text-900 font-medium text-sm mb-2">Category</label>
      <p-dropdown
        [options]="categories$ | async"
        styleClass="w-full"
        formControlName="categoryId"
        placeholder="Select category"
        optionLabel="name"
        optionValue="uid"
      ></p-dropdown>
      <app-error [control]="form.controls.categoryId" field="Category"></app-error>
    </div>

    <div class="col-12">
      <label class="block text-900 font-medium text-sm mb-2">Account</label>
      <p-dropdown
        [options]="accounts$ | async"
        styleClass="w-full"
        formControlName="accountId"
        placeholder="Select account"
        optionLabel="name"
        optionValue="uid"
      ></p-dropdown>
      <app-error [control]="form.controls.accountId" field="Account"></app-error>
    </div>

    <div class="col-12">
      <label class="block text-900 font-medium text-sm mb-2">Date</label>
      <p-calendar
        formControlName="date"
        styleClass="w-full"
      ></p-calendar>
      <app-error [control]="form.controls.date" field="Date"></app-error>
    </div>

    <div class="col-12">
      <label class="block text-900 font-medium text-sm mb-2">Description</label>
      <textarea
        pInputTextarea
        formControlName="description"
        class="w-full"
        style="resize: none"
      ></textarea>
    </div>
  </div>

  <div class="flex justify-content-end">
    <p-button
      [disabled]="!form.valid || processing"
      (click)="onSubmit()"
      styleClass="flex align-items-center justify-content-center w-full"
      type="submit"
    >
      <ng-template pTemplate="content">
        <span class="font-medium">{{ processing ? 'Processing...' : 'Create' }}</span>
        <span *ngIf="processing" class="pi pi-spin pi-spinner ml-2"></span>
      </ng-template>
    </p-button>
  </div>
</div>
